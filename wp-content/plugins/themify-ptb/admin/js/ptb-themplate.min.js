var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,h,e){a instanceof String&&(a=String(a));for(var l=a.length,b=0;b<l;b++){var c=a[b];if(h.call(e,c,b,a))return{i:b,v:c}}return{i:-1,v:void 0}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,h,e){a!=Array.prototype&&a!=Object.prototype&&(a[h]=e.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};
$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,h,e,l){if(h){e=$jscomp.global;a=a.split(".");for(l=0;l<a.length-1;l++){var b=a[l];b in e||(e[b]={});e=e[b]}a=a[a.length-1];l=e[a];h=h(l);h!=l&&null!=h&&$jscomp.defineProperty(e,a,{configurable:!0,writable:!0,value:h})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,e){return $jscomp.findInternal(this,a,e).v}},"es6-impl","es3");var PTB;
(function(a,h,e,l){PTB={prefix:"ptb_",template_type:!1,init:function(b){b=a.extend({prefix:this.prefix,template_type:this.template_type},b);this.prefix=b.prefix;this.template_type=b.template_type;this.Undelegate();this.bindEvents()},Undelegate:function(){a(e).off("change click")},bindEvents:function(){this.SetupColors();this.SelectGrid();this.InitDraggable();this.InitSortable();this.Open();this.AddRow();this.Delete();this.Save();this.Validate();this.ShowHideSeperator();this.InitTMCE();this.InitDefaultContent();
this.AddIcon();this.DisableItems();InitLanguageTabs();a.event.trigger("PTB.template_load",this.template_type)},SelectGrid:function(){a(e).on("click","."+PTB.prefix+"column_select",function(b){b.preventDefault();a(this).closest("."+PTB.prefix+"grid_list_wrapper").find("li.selected").removeClass("selected");a(this).closest("li").addClass("selected");b='"'+a(this).data("grid")+'"';b=JSON.parse(b).split(",");var c=a(this).closest("."+PTB.prefix+"back_row"),d=c.find("."+PTB.prefix+"back_col");d.removeAttr("class").addClass(PTB.prefix+
"back_col").hide();var c=c.find("."+PTB.prefix+"back_module"),f=b.length,m=c.length,m=m>f?Math.ceil(m/f):1,e=[];if(0<c.length){var g=c.find(".wp-editor-area");0<g.length&&"undefined"!==typeof tinymce&&g.each(function(){var b=a(this).attr("id");tinyMCEPreInit.mceInit[b]&&(e[b]=PTB.GetEditorContent(b))})}for(g=0;g<f;g++){var h=a(d[g]),p=PTB.prefix+"col"+b[g]+" "+PTB.prefix+"show_grid";h.attr("data-grid",b[g]);0===g&&(p+=" first");if(0<c.length){var k=h.find("."+PTB.prefix+"module_holder").first();k.find("."+
PTB.prefix+"back_module").remove();for(var l=0;l<m&&c[l];l++)k.append(c[l]);c.splice(0,m)}h.addClass(p).show()}for(var n in e)tinyMCEPreInit.mceInit[n]&&(tinymce.execCommand("mceRemoveEditor",!1,n),a("#"+n).ptb_wp_editor(),tinymce.execCommand("mceAddEditor",!1,n),PTB.SetEditorContent(n,e[n]));PTB.DestroyInputColor();PTB.SetInputColor(a("#"+PTB.prefix+"row_wrapper").find("."+PTB.prefix+"color_picker"));a.event.trigger("PTB.template_select_grid",[PTB.template_type,b])});0===a("."+PTB.prefix+"grid_list li.selected").length?
a("."+PTB.prefix+"column_select").first().trigger("click"):(a("."+PTB.prefix+"back_row_content ."+PTB.prefix+"back_col[data-grid]").show(),this.PlaceHoldDragger(),PTB.Unique(a("#"+PTB.prefix+"row_wrapper ."+PTB.prefix+"active_module")),"undefined"!==typeof tinymce&&a("#"+PTB.prefix+"row_wrapper ."+PTB.prefix+"wp_editor").each(function(){var b=PTB.GenerateUnique();a(this).attr("id",b).ptb_wp_editor();tinyMCEPreInit.mceInit[b]&&tinymce.execCommand("mceAddEditor",!1,b)}),PTB.SetInputColor(a("#"+PTB.prefix+
"row_wrapper").find("."+PTB.prefix+"color_picker")))},PlaceHoldDragger:function(){a("."+PTB.prefix+"module_holder").each(function(){var b=a(this).find("."+PTB.prefix+"empty_holder_text");0===a(this).find("."+PTB.prefix+"active_module").length?b.show():b.hide()})},equalHeight:function(b){b=b.find("."+PTB.prefix+"back_col:visible");if(1<b.length){b.css("min-height","initial");var c=a(b[0]).height();b.each(function(){a(this).height()>c&&(c=a(this).height())});b.css("min-height",c)}},InitDraggable:function(){a("."+
PTB.prefix+"back_module_panel ."+PTB.prefix+"back_module").draggable({appendTo:"body",helper:"clone",revert:"invalid",snapMode:"inner",connectToSortable:"."+PTB.prefix+"module_holder",stop:function(b,c){var d=a(c.helper[0]);a.event.trigger("PTB.template_drag_start",[d,c,PTB.template_type]);PTB.Unique(d);"custom_text"==d.data("type")?d.find("textarea."+PTB.prefix+"wp_editor").each(function(){var b=PTB.GenerateUnique();a(this).attr("id",b);a("#"+b).ptb_wp_editor();setTimeout(function(){a("#wp-"+b+"-wrap").find(".switch-html").trigger("click")},
1200)}):PTB.SetInputColor(d.find("."+PTB.prefix+"color_picker"));d.find("."+PTB.prefix+"toggle_module").trigger("click");a.event.trigger("PTB.template_drag_end",[d,c,PTB.template_type])}})},InitSortable:function(){a("."+PTB.prefix+"module_holder").sortable({placeholder:PTB.prefix+"ui_state_highlight",items:"."+PTB.prefix+"back_module",connectWith:"."+PTB.prefix+"module_holder",cursor:"move",revert:100,sort:function(b,c){var d=c.item.outerHeight();a("."+PTB.prefix+"module_holder ."+PTB.prefix+"ui_state_highlight").height(d)},
receive:function(b,c){PTB.PlaceHoldDragger();a(this).parent().find("."+PTB.prefix+"empty_holder_text").hide()},start:function(b,c){a(c.item).removeClass(PTB.prefix+"dragged")},stop:function(b,c){var d=a(c.item);d.addClass(PTB.prefix+"dragged");PTB.equalHeight(d.closest("."+PTB.prefix+"back_row"));"undefined"!==typeof tinymce&&d.find("textarea."+PTB.prefix+"wp_editor").each(function(){var b=a(this).attr("id");tinyMCEPreInit.mceInit[b]&&(tinymce.execCommand("mceRemoveEditor",!1,b),tinymce.execCommand("mceAddEditor",
!1,b),PTB.ActiveEdiror(b))})}});a("#"+PTB.prefix+"row_wrapper").sortable({items:"."+PTB.prefix+"back_row",handle:"."+PTB.prefix+"back_row_top",axis:"y",placeholder:PTB.prefix+"ui_state_highlight",sort:function(b,c){var d=c.item.height();a("#"+PTB.prefix+"row_wrapper ."+PTB.prefix+"ui_state_highlight").height(d)}})},Open:function(){a(e).on("click","."+PTB.prefix+"toggle_module,."+PTB.prefix+"toggle_row",function(b){var c=0===a(this).closest("."+PTB.prefix+"active_module").length?a(this).closest("."+
PTB.prefix+"back_row").find("."+PTB.prefix+"back_row_content"):a(this).closest("."+PTB.prefix+"active_module").find("."+PTB.prefix+"back_active_module_content"),d=c.closest("."+PTB.prefix+"back_col"),f="."+PTB.prefix+'back_col[data-grid][class~="'+PTB.prefix+'back_col"][class*="'+PTB.prefix+'col"]';a(this).hasClass(PTB.prefix+"opened")||c.is(":visible")?(a(this).removeClass(PTB.prefix+"opened"),0<d.length&&0==d.find("."+PTB.prefix+"opened").length?d.removeClass("shadow",400,function(){c.slideUp(400,
function(){d.removeClass("fill",400,"swing",function(){d.removeClass("fill");d.siblings(f).show(400);d.find("."+PTB.prefix+"delete_module").show();a("."+PTB.prefix+"module_holder").sortable("enable")})})}):c.slideUp()):(a(this).addClass(PTB.prefix+"opened"),0<d.length&&0!==d.siblings(f).length?d.siblings(f).hide(400,function(){d.addClass("fill");d.find("."+PTB.prefix+"delete_module").hide();c.slideDown(400,function(){d.addClass("shadow");a("."+PTB.prefix+"module_holder").sortable("disable")})}):c.slideDown());
b.preventDefault()})},Delete:function(){a(e).on("click","."+PTB.prefix+"delete_module",function(b){if(confirm(ptb_js.module_delete)){var c=0===a(this).closest("."+PTB.prefix+"active_module").length?a(this).closest("."+PTB.prefix+"back_row"):a(this).closest("."+PTB.prefix+"back_module"),d=c.closest("."+PTB.prefix+"back_row");c.remove();0<d.length&&(PTB.PlaceHoldDragger(),PTB.equalHeight(d))}b.preventDefault()})},AddRow:function(){a("."+PTB.prefix+"add_row").click(function(b){var c=a("."+PTB.prefix+
"first_row").first().clone();c.removeClass(PTB.prefix+"first_row").find("."+PTB.prefix+"back_module").remove();c.find("."+PTB.prefix+"empty_holder_text").show();c.find("."+PTB.prefix+"row_custom_css ").val("");c.find("."+PTB.prefix+"back_col").css("min-height","initial");a("."+PTB.prefix+"back_row").last().after(c);c.find("."+PTB.prefix+"column_select").first().trigger("click");b.preventDefault();PTB.InitSortable()})},Save:function(){a("#"+PTB.prefix+"submit").click(function(b){var c=a(".ptb_toggle_module.ptb_opened"),
d=0;0<c.length&&(c.click(),d=1500);var f=a(this).closest("form"),m=a("."+PTB.prefix+"back_builder").find("input,select,textarea");m.attr("disabled","disabled");setTimeout(function(){var b=PTB.ParseData();a.event.trigger("PTB.before_template_save",b);b=JSON.stringify(b);a("#"+PTB.prefix+"layout").val(b);a.ajax({url:f.attr("action"),method:"POST",dataType:"json",data:f.serialize(),beforeSend:function(){f.addClass(PTB.prefix+"wait")},complete:function(){m.removeAttr("disabled");f.removeClass(PTB.prefix+
"wait")},success:function(b){b&&"1"==b.status&&(a("#"+PTB.prefix+"success_text").addClass("ptb_success"),setTimeout(function(){a("#"+PTB.prefix+"success_text").removeClass("ptb_success")},2E3),a.event.trigger("PTB.after_template_save"))}})},d);b.preventDefault()})},Validate:function(){var b=a('input[name="'+PTB.prefix+'ptt_offset_post"]');b.keypress(function(a){a=a.which?a.which:a.keyCode;return 46!=a&&31<a&&(48>a||57<a)?!1:!0});a('input[name="'+PTB.prefix+'ptt_pagination_post"]').change(function(c){0==
a(this).val()?b.attr("disabled","disabled"):b.removeAttr("disabled")});a('input[name="'+PTB.prefix+'ptt_pagination_post"]:checked').trigger("change")},ParseData:function(){var b={};a("#"+PTB.prefix+"row_wrapper").find("."+PTB.prefix+"back_row").each(function(c){b[c]={};b[c].row_classes=a.trim(a(this).find("."+PTB.prefix+"row_custom_css").val());a(this).find("."+PTB.prefix+"show_grid").each(function(d){var f=a(this).attr("data-grid")+"-"+d;b[c][f]={};a(this).find("."+PTB.prefix+"back_active_module_content").each(function(d){var e=
a(this).data("type");b[c][f][d]={};b[c][f][d].type=e;a(this).find('input:checked,input[type="text"],input[type="number"],input[type="hidden"],textarea,select').each(function(){var g=a(this).attr("name");if(g){var m=g.split("]");if(m){m.pop();var g=[];for(k in m){var h=m[k].split("[");h[1]&&(g[k]=h[1])}var k="arr"===g[2];b[c][f][d].key=g[0];k||b[c][f][d][g[1]]&&!g[2]?k?(b[c][f][d][g[1]]=a(this).val(),b[c][f][d][g[1]]||(b[c][f][d][g[1]]=[])):("object"!==typeof b[c][f][d][g[0]]&&"object"!==typeof b[c][f][d][g[1]]&&
(k=b[c][f][d][g[1]],b[c][f][d][g[1]]=[],b[c][f][d][g[1]][0]=k),b[c][f][d][g[1]].push(a(this).val())):g[2]?(k=g[2],"object"!==typeof b[c][f][d][g[1]]&&(b[c][f][d][g[1]]={}),b[c][f][d][g[1]][k]="custom_text"!==e?a(this).val():PTB.GetEditorContent(a(this).attr("id"))):(a(this).hasClass(PTB.prefix+"color_picker")?(k=a(this).minicolors("rgbaString"),k="rgba(0, 0, 0, 1)"===k?!1:k):k="on"===a(this).val()?!0:a(this).val(),b[c][f][d][g[1]]=k)}}})})})});return b},Unique:function(b){b.each(function(){var b=
a(this);b.find("label").each(function(){var c=a(this).attr("for");if(c&&(c=PTB.Escape(a(this).attr("for")),0<a("#"+c).length)){var d=PTB.GenerateUnique();b.find("#"+c).attr("id",d);a(this).attr("for",d)}});var d=/.*?\[(.+?)\]/ig,f={};b.find('input[type="radio"]').each(function(b){(b=a(this).attr("name"))&&(f[b]=1)});for(var e in f){var h=e.match(d);if(h){var g=PTB.GenerateUnique(),l=b.find('input:radio[name="'+e+'"]'),h=g+h[0]+h[1];l.attr("name",h);b.find('input:radio[name!="'+e+'"]')&&b.find('input:radio[name="'+
h+'"][checked]').prop("checked",!0)}}})},DisableItems:function(){a(e).on("change",'.ptb_change_disable input[type="radio"],.ptb_change_disable input[type="checkbox"],.ptb_change_disable select',function(){var b=a(this).closest(".ptb_change_disable").data("disabled");if(b||"0"==b){b=b.toString().split(",");a.isArray(b)||(b=[b]);var c=a(this).is(":checkbox")||a(this).is(":radio")?a(this).is(":checked"):1,d=a(this).is(":checkbox")&&1===a(this).closest(".ptb_back_active_module_input").find('input[type="checkbox"]').length?
c?"0":"1":a(this).val(),f=a(this).closest(".ptb_change_disable").data("action"),e=0<a(this).closest(".ptb_lightbox_row").length?a(this).closest(".ptb_lightbox_row_wrapper").find(".ptb_maybe_disabled"):a(this).closest(".ptb_back_active_module_content").find(".ptb_maybe_disabled");1===a(this).closest(".ptb_back_active_module_input").find('input[type="checkbox"]').length&&(c=!c);f?-1!==a.inArray(d,b)?c?e.hide():e.show():e.show():e.prop("disabled",c)}});a('.ptb_change_disable input[type="radio"]:checked,.ptb_change_disable input[type="checkbox"]:checked,.ptb_change_disable select option:selected').trigger("change")},
GenerateUnique:function(){return PTB.prefix+Math.random().toString(36).substr(2,9)},Escape:function(a){return a.replace(/(:|\.|\[|\]|,)/g,"\\$1")},GetEditorContent:function(b){return"undefined"!==typeof tinymce&&a("#wp-"+b+"-wrap").hasClass("tmce-active")?tinyMCE.get(b).getContent():a("#"+b).val()},SetEditorContent:function(b,c){c||(c="");"undefined"!==typeof tinymce&&tinymce.get(b).setContent(c);a("#"+b).val(c)},ActiveEdiror:function(b){b=a("#wp-"+b+"-wrap");b.hasClass("html-active")?b.find(".switch-html").trigger("click"):
b.find(".switch-tmce").trigger("click")},ImageUpload:function(b){var c=wp.media.frames.file_frame=wp.media({title:a(this).data("uploader_title"),button:{text:a(this).data("uploader_button_text")},library:{type:"image"},multiple:!1});c.on("select",function(){var d=c.state().get("selection").first().toJSON();a(b).prev().val(d.url);a(b).closest(".ptb_post_image_wrapper").find(".ptb_post_image_thumb").css("background-image","url("+d.url+")")});c.open()},ShowHideSeperator:function(){a(e).on("change","."+
PTB.prefix+"back_text input:radio",function(){var b=a(this).closest("."+PTB.prefix+"back_active_module_row").next("div");"one_line"===a(this).val()?b.slideDown():b.slideUp()});a("."+PTB.prefix+"back_text input:radio:checked").trigger("change")},InitTMCE:function(){setTimeout(function(){a(".switch-html").trigger("click")},1200)},InitDefaultContent:function(){if(0<a("."+PTB.prefix+"new-themplate").length){var b=a("#"+PTB.prefix+"cmb_title").clone(),c=a("#"+PTB.prefix+"cmb_editor").clone();a("."+PTB.prefix+
"back_col.first ."+PTB.prefix+"module_holder").append(b).append(c).find("."+PTB.prefix+"empty_holder_text").hide()}},SetupColors:function(){a("#"+PTB.prefix+"row_wrapper").find("."+PTB.prefix+"color_picker").each(function(){var b=PTB.RgbaToHex(a(this).data("value"));b&&-1!==b.indexOf("@")&&(b=b.split("@"),a(this).val(b[0]),a(this).attr("data-opacity",b[1]))})},SetInputColor:function(b){b||(b=a("."+PTB.prefix+"color_picker"));b.minicolors({opacity:!0,position:"top right",theme:"default",show:function(){a("."+
PTB.prefix+"module_holder").sortable("disable")},hide:function(){a("."+PTB.prefix+"module_holder").sortable("enable")},create:function(a){}})},DestroyInputColor:function(){a("#"+PTB.prefix+"row_wrapper").find("."+PTB.prefix+"color_picker").minicolors("destroy")},RgbaToHex:function(a){if(!a)return!1;var b=(a=a.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(.*)[\s+]?\)/i))&&3<=a.length?"#"+("0"+parseInt(a[1],10).toString(16)).slice(-2)+("0"+parseInt(a[2],10).toString(16)).slice(-2)+
("0"+parseInt(a[3],10).toString(16)).slice(-2):"";b&&a[4]&&(b+="@"+a[4]);return b},AddIcon:function(){a(e).delegate(".ptb-icons-list a","click",function(b){b.preventDefault();b=a("#ptb_row_wrapper .ptb_current_ajax");var c=a(this).attr("href");b.prev("input").val("fa-"+c);a(this).closest(".ptb_admin_lightbox").find(".ptb_close_lightbox").trigger("click")})}}})(jQuery,window,document);
